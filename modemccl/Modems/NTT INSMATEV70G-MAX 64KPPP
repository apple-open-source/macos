!! "INSMATEV70G-MAX 64KPPP"! (c) NTT EAST/NTT WEST.!@ORIGINATE@ANSWER!! set up the serial port!serreset 115200, 0, 8, 1!! reset the serial port!hsreset 0 0 0 0 0 0settries 0!@LABEL 1!! set up the terminal adapter!matchclrmatchstr 1 2 "OK\13\10"!! E0    - turn command echo off! Q0V1X3- return detailed result code !                                                         pause 1write "ATE0Q0V1X3\13"matchread 30inctriesiftries 3 59jump 1!@LABEL 2matchclrmatchstr 1 3 "OK\13\10"!! &D1   - regard DTR as ON! $N1=1 - set 64KPPP mode! S0=1  - answer on first ring!pause 1write "AT&D1$N1=1S0=1\13"matchread 30inctriesiftries 2 59!DTRclearpause 5DTRsetflushjump 2!! TA(terminal adapter) ready,so enable answering,or originate a call!@LABEL 3note "INSMATEV70G-MAX Ready"3ifANSWER 30!!! @ORIGINATE!!@LABEL 10matchclrmatchstr  1 11 "CONNECT 64000\13\10"matchstr  2 12 "CONNECT\13\10"matchstr  3 13 "CONNECT 4800\13\10"matchstr  4 14 "CONNECT 9600\13\10"matchstr  5 15 "CONNECT 14400\13\10"matchstr  6 16 "CONNECT 19200\13\10"matchstr  7 17 "CONNECT 28800\13\10"matchstr  8 18 "CONNECT 38400\13\10"matchstr  9 19 "CONNECT 57600\13\10"matchstr 10 32 "RING\13\10"matchstr 11 50 "NO CARRIER\13\10"matchstr 12 51 "ERROR\13\10"matchstr 13 53 "BUSY\13\10"!note "Dialing ^1" 3pause 1write "ATD^1\13"matchread 700jump 59!@LABEL 11note "Communicating at 64000 bps" 3! localized note "Communicating at 64000 bps" 3CommunicatingAt 64000jump 20!@LABEL 12note "Communicating on local mode" 3! localized note "Communicating on local mode." 3jump 20!@LABEL 13note "Communicating at 4800 bps" 3! localized note "Communicating at 4800 bps" 3CommunicatingAt 4800jump 20!@LABEL 14note "Communicating at 9600 bps" 3! localized note "Communicating at 9600 bps" 3CommunicatingAt 9600jump 20!@LABEL 15note "Communicating at 14400 bps" 3! localized note "Communicating at 14400 bps" 3CommunicatingAt 14400jump 20!@LABEL 16note "Communicating at 19200 bps" 3! localized note "Communicating at 19200 bps" 3CommunicatingAt 19200jump 20!@LABEL 17note "Communicating at 28800 bps" 3! localized note "Communicating at 28800 bps" 3CommunicatingAt 28800jump 20!@LABEL 18note "Communicating at 38400 bps" 3! localized note "Communicating at 38400 bps" 3CommunicatingAt 38400jump 20!@LABEL 19note "Communicating at 57600 bps" 3! localized note "Communicating at 57600 bps" 3CommunicatingAt 57600jump 20!@LABEL 20! turn on CTS handshakinghsreset 0 1 0 0 0 0!@LABEL 21exit 0!!! @ANSWER!!@LABEL 30ifORIGINATE 10!@LABEL 31matchclrmatchstr  1 11 "CONNECT 64000\13\10"matchstr  2 12 "CONNECT\13\10"matchstr  3 13 "CONNECT 4800\13\10"matchstr  4 14 "CONNECT 9600\13\10"matchstr  5 15 "CONNECT 14400\13\10"matchstr  6 16 "CONNECT 19200\13\10"matchstr  7 17 "CONNECT 28800\13\10"matchstr  8 18 "CONNECT 38400\13\10"matchstr  9 19 "CONNECT 57600\13\10"matchstr 10 32 "RING\13\10"!matchread 700jump 31!!@LABEL 32userhook 1jump 31!!! error messages!!! NO CARRIER@LABEL 50exit -6021!! ERROR@LABEL 51exit -6016!! BUSY@LABEL 53exit -6022!! TA Not Responding @LABEL 59exit -6019!!! Hang up the TA!!@HANGUPmatchclrmatchstr 1 63 "NO CARRIER\13\10"matchstr 2 63 "OK\13\10"matchstr 3 63 "ERROR\13\10"matchstr 4 61 "CONNECT "!@LABEL 60settries 0hsreset 0 0 0 0 0 0!@LABEL 61!! try to get control of the TA!pause 15write "+++"pause 15!write "ATH\13"matchread 30inctriesiftries 10 59!DTRclearpause 5DTRsetflushjump 61!@LABEL 63pause 15matchclrmatchstr 1 65 "OK\13\10"pause 1write "ATZ\13"matchread 30jump 59!@LABEL 65exit 0!